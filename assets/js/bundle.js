"use strict";var currentGame=void 0,strict=!1,gameOn=!1,maxLength=20,stepDisplay=document.querySelector("#display"),red=document.querySelector("#red"),blue=document.querySelector("#blue"),green=document.querySelector("#green"),yellow=document.querySelector("#yellow"),grid=[{cell:0,color:"red",baseColor:"#841313",highlightColor:"#e01818",el:red},{cell:1,color:"blue",baseColor:"#1d1d8c",highlightColor:"#005dff",el:blue},{cell:2,color:"green",baseColor:"#2a912b",highlightColor:"#23dd16",el:green},{cell:3,color:"yellow",baseColor:"#d3a202",highlightColor:"#ffe100",el:yellow}],Game=function(){this.game=this.newGame()};Game.prototype.incrementPattern=function(){this.game.patternLength+=1},Game.prototype.addToPattern=function(e){var t=Math.floor(4*Math.random());this.game.currentPattern.push(t)},Game.prototype.displayPattern=function(e){var t=this;setTimeout(function(){t.displayInfo();var e=0,r=function(e){e.el.style.backgroundColor=e.highlightColor,setTimeout(function(){e.el.style.backgroundColor=e.baseColor},500/t.game.speed)},n=function(){var n=grid[t.game.currentPattern[e]];r(n),e++};n();var a=setInterval(function(){e>=this.game.currentPattern.length?clearTimeout(a):n()}.bind(t),1e3/t.game.speed)},750)},Game.prototype.resetTurn=function(){this.game.selectedPattern=[],this.incrementPattern()},Game.prototype.takeTurn=function(){this.addToPattern(this.game.patternLength),this.displayPattern(this.game.currentPattern)},Game.prototype.addUserSelection=function(e){this.game.selectedPattern.push(e.target.id),this.game.selectedPattern.length===this.game.currentPattern.length&&this.checkAnswer()},Game.prototype.checkAnswer=function(){var e=this,t=this.game.selectedPattern.filter(function(t,r){return t===grid[e.game.currentPattern[r]].color}).length===this.game.currentPattern.length;t||3===this.game.attempts?t||3!==this.game.attempts?t&&this.game.currentPattern===this.game.maxLength?(this.displayInfo(),console.log("You win!")):(this.displayInfo(),this.resetTurn(),this.takeTurn()):this.reset():(this.displayInfo("MISS"),strict?this.takeTurn():(this.game.attempts+=1,this.resetTurn(),this.displayPattern(this.game.currentPattern)))},Game.prototype.newGame=function(){return{strict:strict,currentPattern:[],selectedPattern:[],maxLength:maxLength,patternLength:1,attempts:0,speed:1}},Game.prototype.start=function(){this.newGame(),this.takeTurn()},Game.prototype.reset=function(){this.game=this.newGame(),this.displayInfo()},Game.prototype.displayInfo=function(e){var t=this.game.currentPattern.length;stepDisplay.value="MISS"===e?"!!":t};var resetText="Reset",startText="Start!",newGameBtn=document.querySelector("#newGame"),toggleStrictBtn=document.querySelector("#toggleStrict"),indicator=document.querySelector("#indicator");newGameBtn.addEventListener("click",function(){gameOn?currentGame.reset():(currentGame=new Game).start(),gameOn=!gameOn,newGameBtn.innerHTML=gameOn?resetText:startText}),toggleStrictBtn.addEventListener("click",function(){strict=!strict,indicator.style.backgroundColor=strict?"red":"white"});for(var _loop=function(e){grid[e].el.addEventListener("click",function(e){return currentGame.addUserSelection(e)}),grid[e].el.addEventListener("mousedown",function(t){return t.target.style.backgroundColor=grid[e].highlightColor}),grid[e].el.addEventListener("mouseup",function(t){return t.target.style.backgroundColor=grid[e].baseColor})},i=0;i<grid.length;i++)_loop(i);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNpbW9uLmpzIl0sIm5hbWVzIjpbImN1cnJlbnRHYW1lIiwic3RyaWN0IiwiZ2FtZU9uIiwibWF4TGVuZ3RoIiwic3RlcERpc3BsYXkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZWQiLCJibHVlIiwiZ3JlZW4iLCJ5ZWxsb3ciLCJncmlkIiwiY2VsbCIsImNvbG9yIiwiYmFzZUNvbG9yIiwiaGlnaGxpZ2h0Q29sb3IiLCJlbCIsIkdhbWUiLCJ0aGlzIiwiZ2FtZSIsIm5ld0dhbWUiLCJwcm90b3R5cGUiLCJpbmNyZW1lbnRQYXR0ZXJuIiwicGF0dGVybkxlbmd0aCIsImFkZFRvUGF0dGVybiIsImxlbmd0aCIsImNlbGxJZHgiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJjdXJyZW50UGF0dGVybiIsInB1c2giLCJkaXNwbGF5UGF0dGVybiIsInBhdHRlcm4iLCJfdGhpcyIsInNldFRpbWVvdXQiLCJkaXNwbGF5SW5mbyIsImlkeCIsImhpZ2hsaWdodCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwic3BlZWQiLCJuZXh0IiwiaGlnaGxpZ2h0ZXIiLCJzZXRJbnRlcnZhbCIsImNsZWFyVGltZW91dCIsImJpbmQiLCJyZXNldFR1cm4iLCJzZWxlY3RlZFBhdHRlcm4iLCJ0YWtlVHVybiIsImFkZFVzZXJTZWxlY3Rpb24iLCJlIiwidGFyZ2V0IiwiaWQiLCJjaGVja0Fuc3dlciIsIl90aGlzMiIsIndpbm5lciIsImZpbHRlciIsImkiLCJhdHRlbXB0cyIsImNvbnNvbGUiLCJsb2ciLCJyZXNldCIsInN0YXJ0IiwiYWN0aW9uIiwic3RlcHMiLCJ2YWx1ZSIsInJlc2V0VGV4dCIsInN0YXJ0VGV4dCIsIm5ld0dhbWVCdG4iLCJ0b2dnbGVTdHJpY3RCdG4iLCJpbmRpY2F0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5uZXJIVE1MIiwiX2xvb3AiXSwibWFwcGluZ3MiOiJBQUFBLGFBSUEsSUFBQUEsaUJBQUEsRUFDQUMsUUFBQSxFQUNBQyxRQUFB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bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vKiBqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXG5cbnZhciBjdXJyZW50R2FtZSA9IHZvaWQgMDtcbnZhciBzdHJpY3QgPSBmYWxzZTtcbnZhciBnYW1lT24gPSBmYWxzZTtcbnZhciBtYXhMZW5ndGggPSAyMDtcblxudmFyIHN0ZXBEaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkaXNwbGF5XCIpO1xuXG52YXIgcmVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyZWRcIik7XG52YXIgYmx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYmx1ZVwiKTtcbnZhciBncmVlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZ3JlZW5cIik7XG52YXIgeWVsbG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN5ZWxsb3dcIik7XG52YXIgZ3JpZCA9IFt7IGNlbGw6IDAsIGNvbG9yOiAncmVkJywgYmFzZUNvbG9yOiAnIzg0MTMxMycsIGhpZ2hsaWdodENvbG9yOiAnI2UwMTgxOCcsIGVsOiByZWQgfSwgeyBjZWxsOiAxLCBjb2xvcjogJ2JsdWUnLCBiYXNlQ29sb3I6ICcjMWQxZDhjJywgaGlnaGxpZ2h0Q29sb3I6ICcjMDA1ZGZmJywgZWw6IGJsdWUgfSwgeyBjZWxsOiAyLCBjb2xvcjogJ2dyZWVuJywgYmFzZUNvbG9yOiAnIzJhOTEyYicsIGhpZ2hsaWdodENvbG9yOiAnIzIzZGQxNicsIGVsOiBncmVlbiB9LCB7IGNlbGw6IDMsIGNvbG9yOiAneWVsbG93JywgYmFzZUNvbG9yOiAnI2QzYTIwMicsIGhpZ2hsaWdodENvbG9yOiAnI2ZmZTEwMCcsIGVsOiB5ZWxsb3cgfV07XG5cbnZhciBHYW1lID0gZnVuY3Rpb24gR2FtZSgpIHtcbiAgdGhpcy5nYW1lID0gdGhpcy5uZXdHYW1lKCk7XG59O1xuR2FtZS5wcm90b3R5cGUuaW5jcmVtZW50UGF0dGVybiA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5nYW1lLnBhdHRlcm5MZW5ndGggKz0gMTtcbn07XG5HYW1lLnByb3RvdHlwZS5hZGRUb1BhdHRlcm4gPSBmdW5jdGlvbiAobGVuZ3RoKSB7XG4gIHZhciBjZWxsSWR4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNCk7XG4gIHRoaXMuZ2FtZS5jdXJyZW50UGF0dGVybi5wdXNoKGNlbGxJZHgpO1xufTtcbkdhbWUucHJvdG90eXBlLmRpc3BsYXlQYXR0ZXJuID0gZnVuY3Rpb24gKHBhdHRlcm4pIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICBfdGhpcy5kaXNwbGF5SW5mbygpO1xuICAgIHZhciBpZHggPSAwO1xuXG4gICAgdmFyIGhpZ2hsaWdodCA9IGZ1bmN0aW9uIGhpZ2hsaWdodChjZWxsKSB7XG4gICAgICBjZWxsLmVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNlbGwuaGlnaGxpZ2h0Q29sb3I7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2VsbC5lbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjZWxsLmJhc2VDb2xvcjtcbiAgICAgIH0sIDUwMCAvIF90aGlzLmdhbWUuc3BlZWQpO1xuICAgIH07XG5cbiAgICB2YXIgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB2YXIgY2VsbCA9IGdyaWRbX3RoaXMuZ2FtZS5jdXJyZW50UGF0dGVybltpZHhdXTtcbiAgICAgIGhpZ2hsaWdodChjZWxsKTtcbiAgICAgIGlkeCsrO1xuICAgIH07XG4gICAgbmV4dCgpO1xuXG4gICAgdmFyIGhpZ2hsaWdodGVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGlkeCA+PSB0aGlzLmdhbWUuY3VycmVudFBhdHRlcm4ubGVuZ3RoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChoaWdobGlnaHRlcik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG5leHQoKTtcbiAgICB9LmJpbmQoX3RoaXMpLCAxMDAwIC8gX3RoaXMuZ2FtZS5zcGVlZCk7XG4gIH0sIDc1MCk7XG59O1xuR2FtZS5wcm90b3R5cGUucmVzZXRUdXJuID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmdhbWUuc2VsZWN0ZWRQYXR0ZXJuID0gW107XG4gIHRoaXMuaW5jcmVtZW50UGF0dGVybigpO1xufTtcbkdhbWUucHJvdG90eXBlLnRha2VUdXJuID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmFkZFRvUGF0dGVybih0aGlzLmdhbWUucGF0dGVybkxlbmd0aCk7XG4gIHRoaXMuZGlzcGxheVBhdHRlcm4odGhpcy5nYW1lLmN1cnJlbnRQYXR0ZXJuKTtcbn07XG5HYW1lLnByb3RvdHlwZS5hZGRVc2VyU2VsZWN0aW9uID0gZnVuY3Rpb24gKGUpIHtcbiAgdGhpcy5nYW1lLnNlbGVjdGVkUGF0dGVybi5wdXNoKGUudGFyZ2V0LmlkKTsgLy8gZXg6ICdncmVlbidcbiAgaWYgKHRoaXMuZ2FtZS5zZWxlY3RlZFBhdHRlcm4ubGVuZ3RoID09PSB0aGlzLmdhbWUuY3VycmVudFBhdHRlcm4ubGVuZ3RoKSB7XG4gICAgdGhpcy5jaGVja0Fuc3dlcigpO1xuICB9XG59O1xuR2FtZS5wcm90b3R5cGUuY2hlY2tBbnN3ZXIgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gIHZhciB3aW5uZXIgPSB0aGlzLmdhbWUuc2VsZWN0ZWRQYXR0ZXJuLmZpbHRlcihmdW5jdGlvbiAoY29sb3IsIGkpIHtcbiAgICByZXR1cm4gY29sb3IgPT09IGdyaWRbX3RoaXMyLmdhbWUuY3VycmVudFBhdHRlcm5baV1dLmNvbG9yO1xuICB9KS5sZW5ndGggPT09IHRoaXMuZ2FtZS5jdXJyZW50UGF0dGVybi5sZW5ndGg7XG5cbiAgaWYgKCF3aW5uZXIgJiYgdGhpcy5nYW1lLmF0dGVtcHRzICE9PSAzKSB7XG4gICAgdGhpcy5kaXNwbGF5SW5mbygnTUlTUycpO1xuXG4gICAgaWYgKHN0cmljdCkge1xuICAgICAgdGhpcy50YWtlVHVybigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdhbWUuYXR0ZW1wdHMgKz0gMTtcbiAgICAgIHRoaXMucmVzZXRUdXJuKCk7XG4gICAgICB0aGlzLmRpc3BsYXlQYXR0ZXJuKHRoaXMuZ2FtZS5jdXJyZW50UGF0dGVybik7XG4gICAgfVxuICB9IGVsc2UgaWYgKCF3aW5uZXIgJiYgdGhpcy5nYW1lLmF0dGVtcHRzID09PSAzKSB7XG4gICAgdGhpcy5yZXNldCgpO1xuICB9IGVsc2UgaWYgKHdpbm5lciAmJiB0aGlzLmdhbWUuY3VycmVudFBhdHRlcm4gPT09IHRoaXMuZ2FtZS5tYXhMZW5ndGgpIHtcbiAgICB0aGlzLmRpc3BsYXlJbmZvKCk7XG4gICAgY29uc29sZS5sb2coJ1lvdSB3aW4hJyk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5kaXNwbGF5SW5mbygpO1xuICAgIHRoaXMucmVzZXRUdXJuKCk7XG4gICAgdGhpcy50YWtlVHVybigpO1xuICB9XG59O1xuR2FtZS5wcm90b3R5cGUubmV3R2FtZSA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHtcbiAgICBzdHJpY3Q6IHN0cmljdCxcbiAgICBjdXJyZW50UGF0dGVybjogW10sXG4gICAgc2VsZWN0ZWRQYXR0ZXJuOiBbXSxcbiAgICBtYXhMZW5ndGg6IG1heExlbmd0aCxcbiAgICBwYXR0ZXJuTGVuZ3RoOiAxLFxuICAgIGF0dGVtcHRzOiAwLFxuICAgIHNwZWVkOiAxXG4gIH07XG59O1xuR2FtZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMubmV3R2FtZSgpO1xuICB0aGlzLnRha2VUdXJuKCk7XG59O1xuR2FtZS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuZ2FtZSA9IHRoaXMubmV3R2FtZSgpO1xuICB0aGlzLmRpc3BsYXlJbmZvKCk7XG59O1xuR2FtZS5wcm90b3R5cGUuZGlzcGxheUluZm8gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gIHZhciBzdGVwcyA9IHRoaXMuZ2FtZS5jdXJyZW50UGF0dGVybi5sZW5ndGg7XG4gIHN0ZXBEaXNwbGF5LnZhbHVlID0gYWN0aW9uID09PSAnTUlTUycgPyAnISEnIDogc3RlcHM7XG59O1xuXG52YXIgcmVzZXRUZXh0ID0gJ1Jlc2V0JztcbnZhciBzdGFydFRleHQgPSAnU3RhcnQhJztcbnZhciBuZXdHYW1lQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXdHYW1lXCIpO1xudmFyIHRvZ2dsZVN0cmljdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlU3RyaWN0XCIpO1xudmFyIGluZGljYXRvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW5kaWNhdG9yXCIpO1xuXG5uZXdHYW1lQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICBpZiAoIWdhbWVPbikge1xuICAgIGN1cnJlbnRHYW1lID0gbmV3IEdhbWUoKTtcbiAgICBjdXJyZW50R2FtZS5zdGFydCgpO1xuICB9IGVsc2Uge1xuICAgIGN1cnJlbnRHYW1lLnJlc2V0KCk7XG4gIH1cbiAgZ2FtZU9uID0gIWdhbWVPbjtcbiAgbmV3R2FtZUJ0bi5pbm5lckhUTUwgPSBnYW1lT24gPyByZXNldFRleHQgOiBzdGFydFRleHQ7XG59KTtcbnRvZ2dsZVN0cmljdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgc3RyaWN0ID0gIXN0cmljdDtcbiAgaW5kaWNhdG9yLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHN0cmljdCA/ICdyZWQnIDogJ3doaXRlJztcbn0pO1xuXG52YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChpKSB7XG4gIGdyaWRbaV0uZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBjdXJyZW50R2FtZS5hZGRVc2VyU2VsZWN0aW9uKGUpO1xuICB9KTtcbiAgZ3JpZFtpXS5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBncmlkW2ldLmhpZ2hsaWdodENvbG9yO1xuICB9KTtcbiAgZ3JpZFtpXS5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gZ3JpZFtpXS5iYXNlQ29sb3I7XG4gIH0pO1xufTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCBncmlkLmxlbmd0aDsgaSsrKSB7XG4gIF9sb29wKGkpO1xufSJdfQ==
